---
import { getEntry, render } from "astro:content";
import Markdown from "@components/misc/Markdown.astro";
import MainGridLayout from "@layouts/MainGridLayout.astro";
import { Icon } from "astro-icon/components";
import { siteConfig } from "../config";
import { friends } from "../friends_data";
import GiscusComments from "@components/GiscusComments.astro";

// 获取友链说明内容
const friendsPost = await getEntry("spec", "friends");

if (!friendsPost) {
	throw new Error("Friends page content not found");
}

const { Content, headings } = await render(friendsPost);
---

<MainGridLayout title="友情链接" description={siteConfig.description}>
    <div class="card-base p-6 md:p-8">
        <div class="flex items-center gap-2 mb-6">
            <div class="h-8 w-8 rounded-lg bg-[var(--primary)] flex items-center justify-center text-white dark:text-black/70">
                <Icon name="material-symbols:diversity-3" class="text-[1.5rem]">
            </div>
            <h1 class="text-2xl font-bold text-black dark:text-white">友情链接</h1>
        </div>

        <!-- 申请友链 -->
        <div class="sponsors-section mb-8">
            <Markdown class="mt-2 markdown-content">
                <Content />
            </Markdown>
        </div>

        <!-- 友链说明 -->
        <div class="mb-4">
            <p class="text-sm text-black/60 dark:text-white/60 text-center">
                ✨ 友链无序，情谊有价
            </p>
        </div>
        <br>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            {friends.map((friend) => (
                <a href={friend.url} target="_blank" rel="noopener noreferrer" class="friend-card">
                    <div class="flex items-center gap-2">
                        <img src={friend.avatar} loading="lazy" class="w-5 h-5 rounded" alt={friend.name}>
                        <div class="font-bold text-black dark:text-white">{friend.name}</div>
                    </div>
                    <div class="text-sm text-black/50 dark:text-white/50">{friend.description}</div>
                </a>
            ))}
        </div>
        <Markdown class="my-8">
            <hr>
        </Markdown>
        <!-- 评论区 -->
        <GiscusComments />


</MainGridLayout>

<style>
.friend-card {
    @apply flex flex-col gap-1 p-4 rounded-lg transition;
    background: linear-gradient(135deg, rgba(156, 163, 175, 0.08) 0%, rgba(209, 213, 219, 0.08) 100%);
    border: 1px solid rgba(156, 163, 175, 0.15);
}

.friend-card:hover {
    background: linear-gradient(135deg, rgba(156, 163, 175, 0.12) 0%, rgba(209, 213, 219, 0.12) 100%);
    border-color: rgba(156, 163, 175, 0.25);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.dark .friend-card {
    background: linear-gradient(135deg, rgba(75, 85, 99, 0.12) 0%, rgba(107, 114, 128, 0.12) 100%);
    border-color: rgba(75, 85, 99, 0.25);
}

.dark .friend-card:hover {
    background: linear-gradient(135deg, rgba(75, 85, 99, 0.18) 0%, rgba(107, 114, 128, 0.18) 100%);
    border-color: rgba(75, 85, 99, 0.35);
}
</style>